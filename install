#!/bin/bash
set -e

echo "ðŸ“¦ MD TUI - Rust Installer"
echo "=========================="

# Install system dependencies
echo "ðŸ“¥ Installing system dependencies..."
sudo apt update
sudo apt install -y \
    build-essential \
    git \
    curl \
    chafa \
    exiftool \
    poppler-utils \
    fzf \
    fd-find \
    ripgrep

# Install Rust if not present
if ! command -v rustc &> /dev/null; then
    echo "ðŸ§Š Installing Rust..."
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
    source "$HOME/.cargo/env"
fi

# Ensure Rust is in PATH
export PATH="$HOME/.cargo/bin:$PATH"

# Build the application
echo "ðŸ”¨ Building MD TUI..."
cargo build --release

# Install binary
echo "ðŸ“² Installing mdtui binary..."
cp target/release/mdtui ~/.local/bin/mdtui
chmod +x ~/.local/bin/mdtui

echo "âœ… Installation complete!"
echo "Run 'mdtui' to start"
